import requests

url = 'http://localhost/eval'
shellcode = "__import__('os').system('cat /etc/passwd')"

# Validate and sanitize input
if not re.match("^[a-zA-Z0-9_]+$", shellcode):
    logging.error("Invalid input detected")
    return "Invalid input"

data = {'input_data': shellcode}

# Use a logging library that supports structured logging and automatic escaping
logger = logging.getLogger(__name__)
handler = RotatingFileHandler('application.log', maxBytes=10000, backupCount=5)
logger.addHandler(handler)

# Log the shellcode
logger.info('Executing shellcode', extra={'shellcode': shellcode})

# No need to execute the shellcode, just log it
# response = requests.post(url, data=data)

# print(response.text)


