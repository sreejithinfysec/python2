import requests
from xml.etree.ElementTree import fromstring
import logging
import json
from defusedxml.ElementTree import fromstring

url = 'http://localhost/xml'
shellcode = '''<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY>
  <!ENTITY xxe SYSTEM
  "file:///etc/passwd">
]>
<foo>
  &xxe;
</foo>
'''

# Use defusedxml.defuse_stdlib() to sanitize the input
clean_shellcode = defusedxml.defuse_stdlib().sanitize(shellcode)

# Structure the log message and data
log_message = "Processing input"
log_data = {"input": clean_shellcode}

# Set up logging
logger = logging.getLogger(__name__)

# Log the structured data
logger.info(json.dumps({"message": log_message, **log_data}))

data = {'input_data': clean_shellcode}

response = requests.post(url, data=data)

print(response.text)



























































































































